{"version":3,"sources":["../src/utils.ts","../src/config.ts","../src/modal.ts","../src/sanitize.ts","../src/manager.ts","../src/a11y.ts","../src/modal-core.ts","../src/toast.ts","../src/dialogs.ts","../src/i18n.ts","../src/index.ts"],"names":["uid","prefix","createNanoEvents","map","fn","_a","a","defaults","current","ee","config","partial","_b","_c","_d","_e","_f","_g","_h","_i","portal_grandcontainer","toasts_grandcontainer","modal_exports","__export","bare","mount","open","DEFAULT_OPTIONS","DANGEROUS_TAGS","EVENT_ATTR","ARIA_ATTR","DATA_ATTR","isAllowedUrl","url","proto","sanitizeAttributes","el","opts","toRemove","toSet","i","attr","name","value","tag","perTag","existingRel","needed","r","n","unwrapElement","parent","cleanNode","node","children","child","sanitize","html","options","tpl","nodes","out","Manager","existing","z","job","mode","next","lock","body","sbw","pos","slot","margins","spacingPx","top","bottom","left","right","behavior","maxVisible","visible","q","manager","getTabbables","root","selector","isTabbable","isFocusable","getTabIndex","isVisible","style","details","focusFirst","fallback","target","removeTabIndex","trapFocus","container","previouslyFocused","onKeyDown","e","tabbables","first","last","active","restore","ariaHideSiblings","stack","prev","setDragOffset","x","y","enableDragging","surfaceEl","handleEl","spec","startX","startY","baseX","baseY","moving","point","t","readTranslate","dx","dy","clampViewport","nx","ny","vw","vh","minX","maxX","minY","maxY","onMove","p","onUp","onDown","createSurface","core","id","cfg","animEnabled","animDur","animEase","overlayFade","overlay","modal","headerEl","bodyEl","footerEl","isClosing","releaseTrap","restoreAria","cleanupDrag","_el","_contentEl","instance","result","close","onEsc","render","_j","_k","_l","_m","_n","_o","_p","alpha","overlayBlur","surfaceAlpha","surfaceBlur","sz","initial","drag","prefersCoarse","isMobileUA","disableOnMobile","axis","withinViewport","cursor","bind","teardown","doneModal","doneOverlay","tryDone","onModalEnd","onOverlayEnd","i18n","inst","header","hasTitle","geti18Title","kind","computedTitle","c","_inst","setContentEl","footer","btns","defaultButton","btn","b","originalOnOpen","ctx","h","bd","bb","windowed","px","v","prefersReducedMotion","removeMatchingClasses","re","cls","onceAnimationEnd","expectedMs","done","called","onEnd","ev","timer","resolveAnim","position","phase","baseDur","baseEase","def","autoDirection","defaultDistance","preset","dir","distance","offscreen","subtle","applyAnim","resolved","addTimeoutCue","animations","timeoutMs","cue","thickness","cover","bar","collapseAndRemove","durationMs","easing","startH","beginExit","toastEl","userExitSpec","exitResolved","toast","contentContainer","titleId","bodyId","enterResolved","question","message","buttons","onDismissal","title","modalOpts","resolve","confirm","alert","prompt","defaultValue","inputValue","errorEl","safeResolve","validateInput","trimmed","contentWrapper","messageP","inputEl","error","i18n_exports","getAvailable","load","register","set","use","registry","bundle","locale","pack","loader","version","api"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\r\n * PromptJS – utils.ts\r\n * Small internal utilities shared across modules.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * Includes:\r\n *   - uid(prefix): generate short unique ids for instances (e.g., 'pj-abc123')\r\n *   - createNanoEvents(): tiny event emitter (on/off/emit)\r\n *   - setAttributes(el, attrs): batch-assign attributes safely\r\n *\r\n * Keep this file dependency-free and stable—other modules assume these helpers exist.\r\n */\r\n\r\nexport function uid(prefix='pj'){ return `${prefix}-${Math.random().toString(36).slice(2,8)}`; }\r\n\r\n// This is a minimal event emitter implementation, inspired by nanoevents (https://github.com/ai/nanoevents)\r\nexport function createNanoEvents(){\r\n  const map = new Map<string, Set<Function>>();\r\n  return {\r\n    on(t:string, fn:Function){ if(!map.has(t)) map.set(t,new Set()); map.get(t)!.add(fn); },\r\n    off(t:string, fn:Function){ map.get(t)?.delete(fn); },\r\n    emit(t:string, ...a:any[]){ map.get(t)?.forEach(fn=>fn(...a)); }\r\n  };\r\n}\r\n\r\nexport function setAttributes(el: HTMLElement, attrs: Record<string,string|number|boolean|undefined>){\r\n  for (const [k,v] of Object.entries(attrs)) if (v !== undefined) el.setAttribute(k, String(v));\r\n}\r\n","/**\r\n * PromptJS – config.ts\r\n * Central runtime configuration store and defaults.\r\n * Uses a simple event emitter to notify changes.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * Exposes:\r\n *   - config.get(): read the current configuration\r\n *   - config.update(partial): shallow-merge updates (with deep-merge for breakpoints/icons/toast)\r\n *   - config.onChange(fn): subscribe to changes (returns unsubscribe)\r\n *\r\n * Covers theme (light/dark/auto), container, z-index base, animation, i18n,\r\n * a11y hints, breakpoints, icon overrides, modal concurrency, and toast defaults.\r\n */\r\n\r\nimport { createNanoEvents } from \"./utils\";\r\nimport type {\r\n  Theme,\r\n  ModalConcurrency,\r\n  ToastPosition,\r\n  ToastBehavior,\r\n  ToastAnimations,\r\n} from \"./types\";\r\n\r\nexport interface PromptJSConfig {\r\n  theme: Theme;\r\n  container: HTMLElement | null;\r\n  zIndexBase: number;\r\n  animation: { enable: boolean; durationMs: number; easing?: string };  \r\n  i18n: {\r\n    locale: string;\r\n    dir: \"ltr\" | \"rtl\" | \"auto\";\r\n    ok: string;\r\n    cancel: string;\r\n    yes: string;\r\n    no: string;\r\n    close: string; // aria label for modal close button\r\n    dismiss: string; // aria label for toast dismiss\r\n    titles: {\r\n      info: string;\r\n      success: string;\r\n      warning: string;\r\n      error: string;\r\n      question: string;\r\n    };\r\n  };\r\n  a11y: { ariaModalLabel?: string };\r\n  breakpoints: { sm: number; md: number; lg: number };\r\n  icons: Partial<\r\n    Record<\r\n      \"info\" | \"success\" | \"warning\" | \"error\" | \"question\",\r\n      string | HTMLElement\r\n    >\r\n  >;\r\n  overlay: {\r\n    fade: boolean;\r\n    // surfaceRgb: string;\r\n    surfaceAlpha: number;\r\n    backdropBlurPx: number;\r\n  };\r\n  modal: {\r\n    concurrency: ModalConcurrency;\r\n    // surfaceRgb: string;\r\n    surfaceAlpha?: number;   // 0 to 1, default 1.0 (opaque)\r\n    dialogBlurPx?: number;   // backdrop-filter blur behind the modal (0 = none)\r\n  };\r\n  toast: {\r\n    defaultPosition: ToastPosition; // default 'top-center'\r\n    behavior: ToastBehavior; // 'stack' | 'queue' | 'replace'\r\n    maxVisible: number; // cap per position for stack/queue\r\n    spacingPx: number; // gap between toasts inside a slot\r\n    margins: { top: number; bottom: number; left: number; right: number };\r\n    zBoost: number; // z-index boost above overlays\r\n    animations: ToastAnimations; // enter/exit + timeoutCue defaults (direction may be 'auto')\r\n    defaultTimeoutMs: number; // e.g., 5000; 0 means sticky by default\r\n    defaultDismissible: boolean; // show close button by default\r\n  };\r\n}\r\n\r\nconst defaults: PromptJSConfig = {\r\n  theme: \"auto\",\r\n  container: null,\r\n  zIndexBase: 2000,\r\n  animation: { enable: true, durationMs: 180, easing: \"ease\" },  \r\n  i18n: {\r\n    locale: \"en\",\r\n    dir: \"auto\",\r\n    ok: \"OK\",\r\n    cancel: \"Cancel\",\r\n    yes: \"Yes\",\r\n    no: \"No\",\r\n    close: \"Close\",\r\n    dismiss: \"Dismiss\",\r\n    titles: {\r\n      info: \"Information\",\r\n      success: \"Success\",\r\n      warning: \"Warning\",\r\n      error: \"Error\",\r\n      question: \"Question\",\r\n    },\r\n  },\r\n  a11y: {},\r\n  breakpoints: { sm: 480, md: 640, lg: 800 },\r\n  icons: {},\r\n  overlay: {\r\n    fade: true,    \r\n    surfaceAlpha: 0.6,\r\n    backdropBlurPx: 0,   \r\n  },\r\n  modal: {\r\n    concurrency: \"queue\",\r\n    surfaceAlpha: 1.0,\r\n    dialogBlurPx: 0,\r\n  },\r\n  toast: {\r\n    defaultPosition: \"top-center\",\r\n    behavior: \"stack\",\r\n    maxVisible: 3,\r\n    spacingPx: 10,\r\n    margins: { top: 16, bottom: 16, left: 16, right: 16 },\r\n    zBoost: 100,\r\n    animations: {\r\n      // Final direction and distance are derived in toast.ts when direction === 'auto'\r\n      // based on the chosen position. These are sensible global defaults.\r\n      enter: { preset: \"slide\", direction: \"auto\" },\r\n      exit: { preset: \"slide\", direction: \"auto\" },\r\n      timeoutCue: { show: true, position: \"bottom\", direction: \"shrink\", thicknessPx: 3 },\r\n    },\r\n    defaultTimeoutMs: 4000,\r\n    defaultDismissible: true,\r\n  },\r\n};\r\n\r\nlet current: PromptJSConfig = { ...defaults };\r\nconst ee = createNanoEvents();\r\n\r\nexport const config = {\r\n  get: (): PromptJSConfig => current,\r\n\r\n  update(partial: Partial<PromptJSConfig>) {\r\n    current = {\r\n      ...current,\r\n      ...partial,\r\n      breakpoints: {\r\n        ...current.breakpoints,\r\n        ...(partial.breakpoints || {}),\r\n      },\r\n      icons: {\r\n        ...current.icons,\r\n        ...(partial.icons || {}),\r\n      },\r\n      animation: { ...current.animation, ...(partial.animation || {}) },\r\n      overlay: { ...current.overlay, ...(partial.overlay || {}) },      \r\n      i18n: {\r\n        ...current.i18n,\r\n        ...(partial.i18n || {}),\r\n        titles: {\r\n          ...current.i18n.titles,\r\n          ...(partial.i18n?.titles || {}),\r\n        },\r\n      },\r\n      toast: {\r\n        ...current.toast,\r\n        ...(partial.toast || {}),\r\n        margins: {\r\n          ...current.toast.margins,\r\n          ...(partial.toast?.margins || {}),\r\n        },\r\n        animations: {\r\n          ...current.toast.animations,\r\n          ...(partial.toast?.animations || {}),\r\n          enter: partial.toast?.animations?.enter\r\n            ? {\r\n                ...current.toast.animations.enter,\r\n                ...partial.toast.animations.enter,\r\n              }\r\n            : current.toast.animations.enter,\r\n          exit: partial.toast?.animations?.exit\r\n            ? {\r\n                ...current.toast.animations.exit,\r\n                ...partial.toast.animations.exit,\r\n              }\r\n            : current.toast.animations.exit,\r\n          timeoutCue: partial.toast?.animations?.timeoutCue\r\n            ? {\r\n                ...current.toast.animations.timeoutCue,\r\n                ...partial.toast.animations.timeoutCue,\r\n              }\r\n            : current.toast.animations.timeoutCue,\r\n        },\r\n      },\r\n    };\r\n\r\n    // Apply theme class to documentElement based on updated config\r\n    if (current.theme === \"auto\") {\r\n      document.documentElement.classList.add(\"pj-theme-auto\");\r\n      document.documentElement.classList.remove(\r\n        \"pj-theme-light\",\r\n        \"pj-theme-dark\"\r\n      );      \r\n    } else if (current.theme === \"light\") {\r\n      document.documentElement.classList.add(\"pj-theme-light\");\r\n      document.documentElement.classList.remove(\r\n        \"pj-theme-dark\",\r\n        \"pj-theme-auto\"\r\n      );\r\n    } else if (current.theme === \"dark\") {\r\n      document.documentElement.classList.add(\"pj-theme-dark\");\r\n      document.documentElement.classList.remove(\r\n        \"pj-theme-light\",\r\n        \"pj-theme-auto\"\r\n      );\r\n    }\r\n    // Change theme class for pj-portal and pj-toasts if they exist\r\n      const portal_grandcontainer = document.querySelector(\".pj-portal\");\r\n      const toasts_grandcontainer = document.querySelector(\".pj-toasts\");\r\n      if (portal_grandcontainer) {\r\n        portal_grandcontainer.classList.remove(\"pj-theme-light\", \"pj-theme-dark\", \"pj-theme-auto\");\r\n        portal_grandcontainer.classList.add(\"pj-theme-\" + (current.theme || \"auto\"));\r\n      }\r\n      if (toasts_grandcontainer) {\r\n        toasts_grandcontainer.classList.remove(\"pj-theme-light\", \"pj-theme-dark\", \"pj-theme-auto\");\r\n        toasts_grandcontainer.classList.add(\"pj-theme-\" + (current.theme || \"auto\"));\r\n      }\r\n\r\n    ee.emit(\"change\");\r\n  },\r\n\r\n  onChange(fn: () => void) {\r\n    ee.on(\"change\", fn);\r\n    return () => ee.off(\"change\", fn);\r\n  },\r\n};\r\n","/**\r\n * PromptJS – modal.ts\r\n * Core modal dialog implementation.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * Exposes:\r\n *   - open(options): standard modal dialog with header, content, footer\r\n *  - bare(options): bare modal surface with content only\r\n *  - Both return a ModalInstance with .close(), .contentEl, and .update()\r\n */\r\n \r\n\r\n\r\nimport { sanitize } from \"./sanitize\";\r\nimport { createSurface, type CoreOptions } from \"./modal-core\";\r\nimport type {\r\n  ModalOptions,\r\n  BareModalOptions,\r\n  ModalInstance,\r\n  ButtonDef,\r\n} from \"./types\";\r\nimport { config } from \"./config\";\r\n\r\n/* ---------------- Dialogs: Modal.open(...) ---------------- */\r\n\r\nexport function open(options: ModalOptions): ModalInstance {\r\n  const cfg = config.get();\r\n  const i18n = cfg.i18n;\r\n\r\n  const core: CoreOptions = {\r\n    // chrome\r\n    windowed: true,\r\n    bare: false,\r\n    size: options.size,\r\n    surfaceClass: (options as any).surfaceClass, // optional hooks if you added them\r\n    contentClass: (options as any).contentClass,\r\n\r\n    // visuals\r\n    surfaceAlpha: options.surfaceAlpha,\r\n    dialogBlurPx: options.dialogBlurPx,\r\n    backdropBlurPx: options.backdropBlurPx,\r\n    kind: options.kind,\r\n\r\n    // behavior\r\n    animate: options.animate,\r\n    closeOnEsc: options.closeOnEsc ?? true,\r\n    closeOnBackdrop: options.closeOnBackdrop ?? true,\r\n    trapFocus: options.trapFocus ?? true,\r\n    ariaLabel: options.ariaLabel,\r\n    draggable: options.draggable,\r\n    onOpen: options.onOpen,\r\n    onClose: options.onClose,\r\n    concurrency: options.concurrency,\r\n  };\r\n\r\n  // dialog renderers\r\n  return createSurface(core, {\r\n    renderHeader(inst, header) {\r\n      const hasTitle =\r\n        typeof options.title === \"string\" && options.title.length > 0;\r\n      const geti18Title = (kind: string) => {\r\n        return (i18n.titles as any)[kind] || \"\";\r\n      };\r\n      const computedTitle = hasTitle\r\n        ? options.title\r\n        : options.kind\r\n        ? geti18Title(options.kind)\r\n        : undefined;\r\n\r\n      if (computedTitle) {\r\n        header.innerHTML = `<h2 class=\"pj-modal-title\">${sanitize(\r\n          computedTitle\r\n        )}</h2>`;\r\n      }\r\n\r\n      if (options.showClose ?? true) {\r\n        const c = document.createElement(\"button\");\r\n        c.className = \"pj-modal-close\";\r\n        c.setAttribute(\"aria-label\", options.closeAriaLabel || i18n.close);\r\n        c.innerHTML =\r\n          '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" ' +\r\n          'fill=\"none\" stroke=\"currentColor\" stroke-width=\"4\" aria-hidden=\"true\">' +\r\n          '<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\"/></svg>';\r\n        c.addEventListener(\"click\", () => inst.close(\"close\"));\r\n        header.appendChild(c);\r\n      }\r\n    },\r\n\r\n    renderBody(_inst, body, setContentEl) {\r\n      if (typeof options.content === \"string\") {\r\n        body.innerHTML = options.unsafeHTML\r\n          ? options.content\r\n          : sanitize(options.content);\r\n        setContentEl(body);\r\n      } else {\r\n        body.appendChild(options.content);\r\n        setContentEl(options.content as HTMLElement);\r\n      }\r\n    },\r\n\r\n    renderFooter(inst, footer) {\r\n      const btns: ButtonDef[] = options.buttons ?? [\r\n        { id: \"ok\", text: i18n.ok, variant: \"primary\" },\r\n      ];\r\n      let defaultButton: HTMLButtonElement | null = null;\r\n      \r\n      for (const btn of btns) {\r\n        const b = document.createElement(\"button\");\r\n        b.className = `pj-modal-btn ${btn.variant || \"neutral\"}`;\r\n        b.textContent = btn.text;\r\n        b.setAttribute('data-button-id', btn.id);\r\n        b.addEventListener(\"click\", async () => {\r\n          try {\r\n            b.disabled = true;\r\n            if (btn.onClick) await btn.onClick(inst);\r\n          } finally {\r\n            b.disabled = false;\r\n            if (btn.closeOnClick ?? true) inst.close(btn.id);\r\n          }\r\n        });\r\n        footer.appendChild(b);\r\n        \r\n        // Track default button for focus\r\n        if (options.defaultButtonId && btn.id === options.defaultButtonId) {\r\n          defaultButton = b;\r\n        }\r\n      }\r\n      \r\n      // Focus default button after modal opens\r\n      if (defaultButton) {\r\n        const originalOnOpen = options.onOpen;\r\n        core.onOpen = (ctx) => {\r\n          if (originalOnOpen) originalOnOpen(ctx);\r\n          setTimeout(() => defaultButton?.focus(), 100);\r\n        };\r\n      }\r\n\r\n      // Provide a real update() only for dialog fields\r\n      (inst as any).update = (\r\n        partial: Partial<\r\n          Pick<ModalOptions, \"title\" | \"content\" | \"unsafeHTML\" | \"buttons\">\r\n        >\r\n      ) => {\r\n        if (partial.title !== undefined) {\r\n          const h = inst.el.querySelector(\r\n            \".pj-modal-title\"\r\n          ) as HTMLElement | null;\r\n          if (h) h.textContent = partial.title ?? \"\";\r\n        }\r\n        if (partial.content !== undefined) {\r\n          const bodyEl = inst.el.querySelector(\r\n            \".pj-modal-content\"\r\n          ) as HTMLElement;\r\n          if (!bodyEl) return;\r\n          bodyEl.innerHTML = \"\";\r\n          if (typeof partial.content === \"string\") {\r\n            bodyEl.innerHTML = partial.unsafeHTML\r\n              ? partial.content\r\n              : sanitize(partial.content);\r\n          } else {\r\n            bodyEl.appendChild(partial.content);\r\n          }\r\n          (inst as any)._contentEl = bodyEl; // defensive, though getter is set in core\r\n          // keep the exposed getter consistent\r\n          Object.getOwnPropertyDescriptor(inst, \"contentEl\")?.get &&\r\n            ((_) => _)(bodyEl);\r\n        }\r\n        if (partial.buttons) {\r\n          footer.innerHTML = \"\";\r\n          partial.buttons.forEach((bd) => {\r\n            const bb = document.createElement(\"button\");\r\n            bb.className = `pj-modal-btn ${bd.variant || \"neutral\"}`;\r\n            bb.textContent = bd.text;\r\n            bb.addEventListener(\"click\", async () => {\r\n              try {\r\n                bb.disabled = true;\r\n                if (bd.onClick) await bd.onClick(inst);\r\n              } finally {\r\n                bb.disabled = false;\r\n                if (bd.closeOnClick ?? true) inst.close(bd.id);\r\n              }\r\n            });\r\n            footer.appendChild(bb);\r\n          });\r\n        }\r\n      };\r\n    },\r\n\r\n    setUpdater: (inst, { header, body, footer, setContentEl }) => {\r\n      (inst as any).update = (\r\n        partial: Partial<\r\n          Pick<ModalOptions, \"title\" | \"content\" | \"unsafeHTML\" | \"buttons\">\r\n        >\r\n      ) => {\r\n        // title\r\n        if (partial.title !== undefined && header) {\r\n          const h = header.querySelector(\r\n            \".pj-modal-title\"\r\n          ) as HTMLElement | null;\r\n          if (h) h.textContent = partial.title ?? \"\";\r\n        }\r\n\r\n        // content\r\n        if (partial.content !== undefined) {\r\n          body.innerHTML = \"\";\r\n          if (typeof partial.content === \"string\") {\r\n            body.innerHTML = partial.unsafeHTML\r\n              ? partial.content\r\n              : sanitize(partial.content);\r\n          } else {\r\n            body.appendChild(partial.content);\r\n          }\r\n          setContentEl(body); // keeps inst.contentEl correct without touching privates\r\n        }\r\n\r\n        // buttons (only if footer exists)\r\n        if (partial.buttons && footer) {\r\n          footer.innerHTML = \"\";\r\n          partial.buttons.forEach((bd) => {\r\n            const bb = document.createElement(\"button\");\r\n            bb.className = `pj-modal-btn ${bd.variant || \"neutral\"}`;\r\n            bb.textContent = bd.text;\r\n            bb.addEventListener(\"click\", async () => {\r\n              try {\r\n                bb.disabled = true;\r\n                if (bd.onClick) await bd.onClick(inst);\r\n              } finally {\r\n                bb.disabled = false;\r\n                if (bd.closeOnClick ?? true) inst.close(bd.id);\r\n              }\r\n            });\r\n            footer.appendChild(bb);\r\n          });\r\n        }\r\n      };\r\n    },\r\n  });\r\n}\r\n\r\nexport function bare(options: BareModalOptions = {}): ModalInstance {\r\n  const windowed = options.windowed !== false;\r\n\r\n  const core: CoreOptions = {\r\n    // chrome\r\n    windowed,\r\n    bare: true,\r\n    size: options.size,\r\n    surfaceClass: options.surfaceClass,\r\n    contentClass: options.contentClass,\r\n\r\n    // visuals\r\n    surfaceAlpha: options.surfaceAlpha,\r\n    dialogBlurPx: options.dialogBlurPx,\r\n    backdropBlurPx: options.backdropBlurPx,\r\n    kind: options.kind,\r\n\r\n    // behavior\r\n    animate: options.animate,\r\n    closeOnEsc: options.closeOnEsc ?? true,\r\n    closeOnBackdrop: options.closeOnBackdrop ?? true,\r\n    trapFocus: options.trapFocus ?? true,\r\n    ariaLabel: options.ariaLabel,\r\n    draggable: (() => {\r\n      if (!windowed && options.draggable) {\r\n        const spec =\r\n          typeof options.draggable === \"object\" ? options.draggable : {};\r\n        return {\r\n          handle: spec.handle ?? undefined,\r\n          axis: spec.axis,\r\n          withinViewport: spec.withinViewport,\r\n          disableOnMobile: spec.disableOnMobile,\r\n          cursor: spec.cursor,\r\n        };\r\n      }\r\n      return options.draggable;\r\n    })(),\r\n    onOpen: options.onOpen,\r\n    onClose: options.onClose,\r\n    concurrency: options.concurrency,\r\n  };\r\n\r\n  return createSurface(core, {\r\n    // no header/footer by default\r\n    renderBody(_inst, body, setContentEl) {\r\n      if (typeof options.content === \"string\") {\r\n        body.innerHTML = options.unsafeHTML\r\n          ? options.content\r\n          : sanitize(options.content);\r\n        setContentEl(body);\r\n      } else if (options.content) {\r\n        body.appendChild(options.content);\r\n        setContentEl(options.content as HTMLElement);\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\n/**\r\n * Alias for bare() - mounts custom content in a minimal modal wrapper.\r\n * Provides a more semantic name for mounting DOM elements.\r\n */\r\nexport const mount = bare;\r\n","/**\r\n * PromptJS - sanitize.ts\r\n * Minimal, dependency-free HTML sanitizer for string content.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * - Strips dangerous tags (script, style, iframe, object, embed, form, etc.)\r\n * - Removes inline event handlers (on*)\r\n * - Removes inline styles\r\n * - Restricts attributes to an allow-list (with aria-* and data-* passthrough)\r\n * - Scrubs URLs on <a href> to allowed protocols (http, https, mailto, tel) or relative\r\n * - Unwraps disallowed elements but preserves their text content\r\n *\r\n * NOTE:\r\n * - If you need full control (e.g., custom HTML widgets), pass a DOM Node instead\r\n *   of an HTML string to the API OR set `unsafeHTML: true` (not recommended).\r\n */\r\n\r\nexport interface SanitizeOptions {\r\n  allowedTags: Set<string>;\r\n  allowedGlobalAttrs: Set<string>;\r\n  allowedPerTagAttrs: Record<string, Set<string>>;\r\n  allowDataAttrs: boolean; // data-*\r\n  allowAriaAttrs: boolean; // aria-*\r\n  allowClassAttr: boolean; // class\r\n  allowIdAttr: boolean;    // id\r\n  // Whether to unwrap a disallowed element (keep its children) or drop entirely\r\n  unwrapDisallowed: boolean;\r\n}\r\n\r\nconst DEFAULT_OPTIONS: SanitizeOptions = {\r\n  // Conservative but practical allow-list for modal/notification body content\r\n  allowedTags: new Set([\r\n    // Text & inline\r\n    'b', 'strong', 'i', 'em', 'u', 's', 'span', 'small', 'mark', 'code', 'kbd', 'samp', 'sup', 'sub', 'br',\r\n    // Block\r\n    'p', 'div', 'blockquote', 'pre', 'hr',\r\n    // Lists\r\n    'ul', 'ol', 'li',\r\n    // Headings\r\n    'h1','h2','h3','h4','h5','h6',\r\n    // Links\r\n    'a',\r\n  ]),\r\n  // Global attributes we consider safe\r\n  allowedGlobalAttrs: new Set([\r\n    'title', 'dir', 'lang', 'role',\r\n  ]),\r\n  // Per-tag attributes\r\n  allowedPerTagAttrs: {\r\n    a: new Set(['href', 'target', 'rel', 'name']),\r\n    // Add more tag-specific attrs here if you later allow them (e.g., 'pre' could allow 'tabindex')\r\n  },\r\n  allowDataAttrs: true,\r\n  allowAriaAttrs: true,\r\n  allowClassAttr: true,\r\n  allowIdAttr: false, // generally unnecessary in modal content; can cause collisions\r\n  unwrapDisallowed: true,\r\n};\r\n\r\n// Tags we always drop (never unwrap to avoid weirdness) — feel free to extend\r\nconst DANGEROUS_TAGS = new Set([\r\n  'script', 'style', 'iframe', 'object', 'embed', 'link', 'meta', 'base',\r\n  'form', 'input', 'button', 'textarea', 'select', 'option',\r\n  'svg', 'math', // SVG/MathML can be abused; keep disabled by default\r\n]);\r\n\r\nconst EVENT_ATTR = /^on/i;\r\nconst ARIA_ATTR = /^aria-/i;\r\nconst DATA_ATTR = /^data-/i;\r\n\r\nfunction isAllowedUrl(url: string): boolean {\r\n  // Allow relative URLs, hash links, and ?query links quickly\r\n  const t = url.trim();\r\n  if (!t) return true;\r\n  if (t.startsWith('#') || t.startsWith('?') || t.startsWith('/')) return true;\r\n  if (t.startsWith('./') || t.startsWith('../')) return true;\r\n\r\n  try {\r\n    const u = new URL(t, document.baseURI);\r\n    const proto = u.protocol.toLowerCase();\r\n    return proto === 'http:' || proto === 'https:' || proto === 'mailto:' || proto === 'tel:';\r\n  } catch {\r\n    // If URL parsing fails, treat as unsafe\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction sanitizeAttributes(el: Element, opts: SanitizeOptions) {\r\n  // Copy attribute list first—live NamedNodeMap changes while iterating\r\n  const toRemove: string[] = [];\r\n  const toSet: Array<{ name: string; value: string }> = [];\r\n\r\n  for (let i = 0; i < el.attributes.length; i++) {\r\n    const attr = el.attributes[i];\r\n    const name = attr.name;\r\n    const value = attr.value;\r\n\r\n    // Strip inline event handlers and inline styles immediately\r\n    if (EVENT_ATTR.test(name) || name === 'style') { toRemove.push(name); continue; }\r\n\r\n    // Allow class/id based on options\r\n    if (name === 'class') { if (!opts.allowClassAttr) { toRemove.push(name); } continue; }\r\n    if (name === 'id')    { if (!opts.allowIdAttr)    { toRemove.push(name); } continue; }\r\n\r\n    // data-* and aria-* passthrough\r\n    if (opts.allowDataAttrs && DATA_ATTR.test(name)) continue;\r\n    if (opts.allowAriaAttrs && ARIA_ATTR.test(name)) continue;\r\n\r\n    // Is this a globally allowed attribute?\r\n    if (opts.allowedGlobalAttrs.has(name)) continue;\r\n\r\n    // Is this attribute allowed for this specific tag?\r\n    const tag = el.tagName.toLowerCase();\r\n    const perTag = opts.allowedPerTagAttrs[tag];\r\n    if (perTag && perTag.has(name)) {\r\n      // Special handling for <a href>\r\n      if (tag === 'a' && name === 'href') {\r\n        if (!isAllowedUrl(value)) {\r\n          toRemove.push(name);\r\n          continue;\r\n        }\r\n        // If target=_blank, enforce rel safety\r\n        const target = el.getAttribute('target');\r\n        if (target === '_blank') {\r\n          const existingRel = el.getAttribute('rel') || '';\r\n          const needed = new Set(['noopener', 'noreferrer']);\r\n          existingRel.split(/\\s+/).forEach((r) => r && needed.delete(r.toLowerCase()));\r\n          if (needed.size) {\r\n            toSet.push({ name: 'rel', value: (existingRel ? existingRel + ' ' : '') + Array.from(needed).join(' ') });\r\n          }\r\n        }\r\n      }\r\n      continue;\r\n    }\r\n\r\n    // Otherwise, drop it\r\n    toRemove.push(name);\r\n  }\r\n\r\n  toRemove.forEach((n) => el.removeAttribute(n));\r\n  toSet.forEach(({ name, value }) => el.setAttribute(name, value));\r\n}\r\n\r\nfunction unwrapElement(el: Element) {\r\n  const parent = el.parentNode;\r\n  if (!parent) { el.remove(); return; }\r\n  while (el.firstChild) parent.insertBefore(el.firstChild, el);\r\n  parent.removeChild(el);\r\n}\r\n\r\nfunction cleanNode(node: Node, opts: SanitizeOptions) {\r\n  // Remove comments\r\n  if (node.nodeType === Node.COMMENT_NODE) {\r\n    node.parentNode?.removeChild(node);\r\n    return;\r\n  }\r\n\r\n  if (node.nodeType !== Node.ELEMENT_NODE) return;\r\n\r\n  const el = node as Element;\r\n  const tag = el.tagName.toLowerCase();\r\n\r\n  // Hard drop dangerous tags and their contents\r\n  if (DANGEROUS_TAGS.has(tag)) {\r\n    el.parentNode?.removeChild(el);\r\n    return;\r\n  }\r\n\r\n  // If not allowed, either unwrap or drop\r\n  if (!opts.allowedTags.has(tag)) {\r\n    if (opts.unwrapDisallowed) unwrapElement(el);\r\n    else el.parentNode?.removeChild(el);\r\n    return;\r\n  }\r\n\r\n  // Allowed element → sanitize its attributes\r\n  sanitizeAttributes(el, opts);\r\n\r\n  // Recurse into children (convert NodeList to array first)\r\n  const children = Array.from(el.childNodes);\r\n  for (const child of children) cleanNode(child, opts);\r\n}\r\n\r\n/**\r\n * Sanitize an HTML string and return a safe HTML string.\r\n * If you need a DocumentFragment, you can create one from the returned string.\r\n */\r\nexport function sanitize(html: string, options?: Partial<SanitizeOptions>): string {\r\n  if (!html) return '';\r\n\r\n  const opts: SanitizeOptions = {\r\n    ...DEFAULT_OPTIONS,\r\n    ...(options || {}),\r\n    // Deep-merge perTagAttrs/sets if caller provided them\r\n    allowedTags: options?.allowedTags ? new Set(options.allowedTags) : DEFAULT_OPTIONS.allowedTags,\r\n    allowedGlobalAttrs: options?.allowedGlobalAttrs ? new Set(options.allowedGlobalAttrs) : DEFAULT_OPTIONS.allowedGlobalAttrs,\r\n    allowedPerTagAttrs: options?.allowedPerTagAttrs\r\n      ? Object.fromEntries(Object.entries(options.allowedPerTagAttrs).map(([k, v]) => [k, new Set(v)]))\r\n      : DEFAULT_OPTIONS.allowedPerTagAttrs,\r\n  };\r\n\r\n  // Use <template> to avoid immediate reflow and keep markup isolated\r\n  const tpl = document.createElement('template');\r\n  tpl.innerHTML = html;\r\n\r\n  const nodes = Array.from(tpl.content.childNodes);\r\n  for (const n of nodes) cleanNode(n, opts);\r\n\r\n  // Return sanitized HTML string\r\n  const out = document.createElement('div');\r\n  out.appendChild(tpl.content.cloneNode(true));\r\n  return out.innerHTML;\r\n}\r\n","/**\r\n * PromptJS – manager.ts\r\n * Singleton DOM manager that coordinates shared UI infrastructure.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * Responsibilities:\r\n *   - Create and maintain root containers:\r\n *       .pj-portal   (modals/dialog overlays)\r\n *       .pj-toasts   (overlaying toast layer with per-position slots)\r\n *   - Enforce modal concurrency (queue or reject new opens)\r\n *   - Body scroll lock + scrollbar compensation\r\n *   - Z-index base coordination (toasts sit above overlays)\r\n *   - Toast slots and per-position behavior/queues\r\n *\r\n * No external deps. Works with ES2019 + DOM libs.\r\n */\r\n\r\nimport { config } from './config';\r\nimport type { ToastBehavior, ToastPosition } from './types';\r\n\r\ntype Job = () => void;\r\n\r\nclass Manager {\r\n  portal!: HTMLElement;     // overlay mount (modals/dialogs)\r\n  toastsRoot!: HTMLElement; // root layer for toast slots\r\n\r\n  // Modal state\r\n  private activeModal = 0;\r\n  private modalQueue: Job[] = [];\r\n\r\n  // Toast state\r\n  private toastSlots = new Map<ToastPosition, HTMLElement>();\r\n  private toastQueues = new Map<ToastPosition, Array<{ mount: () => void; maxVisible: number }>>();\r\n\r\n  ensureRoots() {\r\n    const parent = config.get().container ?? document.body;\r\n\r\n    const existing = document.querySelector('.pj-portal') as HTMLElement;\r\n    if (existing && this.portal && existing !== this.portal) {\r\n      existing.remove();\r\n      this.portal = undefined!;\r\n    }   \r\n\r\n    if (!this.portal) {\r\n      this.portal = document.createElement('div');\r\n      this.portal.className = 'pj-portal pj-theme-' + (config.get().theme || 'auto');\r\n      this.portal.style.position = 'relative';\r\n      this.portal.style.zIndex = String(config.get().zIndexBase || 2000);\r\n      parent.appendChild(this.portal);\r\n    }\r\n    else {\r\n      this.portal.style.zIndex = String(config.get().zIndexBase || 2000);\r\n    }     \r\n\r\n    if (!this.toastsRoot) {\r\n      this.toastsRoot = document.createElement('div');\r\n      this.toastsRoot.className = 'pj-toasts pj-theme-' + (config.get().theme || 'auto');\r\n      // Above overlays: base + zBoost\r\n      const z = (config.get().zIndexBase || 2000) + (config.get().toast.zBoost || 100);\r\n      Object.assign(this.toastsRoot.style, {\r\n        position: 'fixed',\r\n        inset: '0',\r\n        zIndex: String(z),\r\n        pointerEvents: 'none',\r\n      } as CSSStyleDeclaration);\r\n      parent.appendChild(this.toastsRoot);\r\n    }\r\n  }\r\n\r\n  // -------- Modal orchestration --------\r\n\r\n  open(job: Job) {\r\n    this.ensureRoots();\r\n    const mode = config.get().modal.concurrency;\r\n    if (this.activeModal > 0 && mode === 'reject') {\r\n      throw new Error('PromptJS: modal already open');\r\n    }\r\n    if (this.activeModal > 0 && mode === 'queue') {\r\n      this.modalQueue.push(job);\r\n      return;\r\n    }\r\n    this.activeModal++;\r\n    job();\r\n  }\r\n\r\n  onClose() {\r\n    this.activeModal = Math.max(0, this.activeModal - 1);\r\n    if (this.modalQueue.length) {\r\n      const next = this.modalQueue.shift()!;\r\n      this.open(next);\r\n    }\r\n  }\r\n\r\n  scrollLock(lock: boolean) {\r\n    const body = document.body;\r\n    if (lock) {\r\n      if (!body.style.getPropertyValue('--pj-scrollbar')) {\r\n        const sbw = window.innerWidth - document.documentElement.clientWidth;\r\n        body.style.setProperty('--pj-scrollbar', `${sbw}px`);\r\n      }\r\n      body.classList.add('pj-lock');\r\n    } else {\r\n      body.classList.remove('pj-lock');\r\n      body.style.removeProperty('--pj-scrollbar');\r\n    }\r\n  }\r\n\r\n  // -------- Toast infrastructure --------\r\n\r\n  private getToastSlot(pos: ToastPosition): HTMLElement {\r\n    this.ensureRoots();\r\n    const existing = this.toastSlots.get(pos);\r\n    if (existing) return existing;\r\n\r\n    const slot = document.createElement('div');\r\n    slot.className = `pj-toast-slot pj-${pos}`;\r\n    slot.style.position = 'fixed';\r\n    slot.style.display = 'flex';\r\n    slot.style.flexDirection = 'column';\r\n    slot.style.pointerEvents = 'none';\r\n\r\n    const { margins, spacingPx } = config.get().toast;\r\n    slot.style.gap = `${spacingPx}px`;\r\n\r\n    const top = `${margins.top}px`;\r\n    const bottom = `${margins.bottom}px`;\r\n    const left = `${margins.left}px`;\r\n    const right = `${margins.right}px`;\r\n\r\n    // Anchor by position\r\n    switch (pos) {\r\n      case 'top-left':\r\n        slot.style.top = top; slot.style.left = left; break;\r\n      case 'top-center':\r\n        slot.style.top = top; slot.style.left = '50%'; slot.style.transform = 'translateX(-50%)'; break;\r\n      case 'top-right':\r\n        slot.style.top = top; slot.style.right = right; break;\r\n      case 'bottom-left':\r\n        slot.style.bottom = bottom; slot.style.left = left; break;\r\n      case 'bottom-center':\r\n        slot.style.bottom = bottom; slot.style.left = '50%'; slot.style.transform = 'translateX(-50%)'; break;\r\n      case 'bottom-right':\r\n        slot.style.bottom = bottom; slot.style.right = right; break;\r\n    }\r\n\r\n    this.toastsRoot.appendChild(slot);\r\n    this.toastSlots.set(pos, slot);\r\n    return slot;\r\n  }\r\n\r\n  /**\r\n   * Mount a toast into its position slot honoring behavior.\r\n   * - stack: append; if full, drop oldest to keep UI responsive\r\n   * - queue: enqueue if full; mount when a slot frees\r\n   * - replace: clear slot and show only the new toast\r\n   */\r\n  showToast(el: HTMLElement, pos: ToastPosition, behavior: ToastBehavior, maxVisible: number) {\r\n    const slot = this.getToastSlot(pos);\r\n    const visible = slot.children.length;\r\n\r\n    // Allow interactions inside toast\r\n    el.style.pointerEvents = 'auto';\r\n\r\n    if (behavior === 'replace') {\r\n      while (slot.firstElementChild) slot.removeChild(slot.firstElementChild);\r\n      slot.appendChild(el);\r\n      return;\r\n    }\r\n\r\n    if (behavior === 'stack') {\r\n      if (visible >= maxVisible) {\r\n        slot.firstElementChild?.remove();\r\n      }\r\n      slot.appendChild(el);\r\n      return;\r\n    }\r\n\r\n    // queue\r\n    if (visible >= maxVisible) {\r\n      const q = this.toastQueues.get(pos) || [];\r\n      q.push({ mount: () => slot.appendChild(el), maxVisible });\r\n      this.toastQueues.set(pos, q);\r\n    } else {\r\n      slot.appendChild(el);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Notify manager that a toast at a position was removed.\r\n   * Used to advance queued toasts for that position.\r\n   */\r\n  onToastRemoved(pos: ToastPosition) {\r\n    const slot = this.getToastSlot(pos);\r\n    const q = this.toastQueues.get(pos);\r\n    if (!q || q.length === 0) return;\r\n\r\n    if (slot.children.length < q[0].maxVisible) {\r\n      const next = q.shift()!;\r\n      next.mount();\r\n    }\r\n  }\r\n}\r\n\r\nexport const manager = new Manager();\r\n","/**\r\n * PromptJS – a11y.ts\r\n * Accessibility utilities shared by modal/notify.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * Features:\r\n *  - getTabbables(root): robust tabbable element query\r\n *  - focusFirst(root, fallback?): focus management helper\r\n *  - trapFocus(container, opts?): keep Tab/Shift+Tab within container; returns { release() }\r\n *  - ariaHideSiblings(target): hide everything except target; returns restore()\r\n *  - createLiveRegion(kind): get/create polite/assertive live region for toasts\r\n *\r\n * No external deps. No async/await. Works with ES2019 + DOM libs.\r\n */\r\n\r\nexport type LiveKind = 'polite' | 'assertive';\r\n\r\nexport interface TrapOptions {\r\n  initialFocus?: HTMLElement | null;   // element to focus on activate\r\n  restoreFocus?: HTMLElement | null;   // element to restore on release (default: previously focused)\r\n}\r\n\r\n/** Return all tabbable descendants within root (in DOM order). */\r\nexport function getTabbables(root: ParentNode): HTMLElement[] {\r\n  const selector = [\r\n    'a[href]',\r\n    'area[href]',\r\n    'button:not([disabled])',\r\n    'input:not([disabled]):not([type=\"hidden\"])',\r\n    'select:not([disabled])',\r\n    'textarea:not([disabled])',\r\n    'summary', // details/summary is focusable\r\n    '[tabindex]',\r\n    '[contenteditable=\"true\"]',\r\n  ].join(',');\r\n\r\n  const nodes = Array.from(root.querySelectorAll<HTMLElement>(selector));\r\n  return nodes.filter(isTabbable);\r\n}\r\n\r\nfunction isTabbable(el: HTMLElement): boolean {\r\n  if (!isFocusable(el)) return false;\r\n  const tabindex = getTabIndex(el);\r\n  return tabindex >= 0;\r\n}\r\n\r\nfunction isFocusable(el: HTMLElement): boolean {\r\n  if (!isVisible(el)) return false;\r\n  // Disabled form controls already filtered by selector, but keep guard:\r\n  // @ts-ignore — HTML*Element may not have disabled\r\n  if ((el as any).disabled) return false;\r\n  return true;\r\n}\r\n\r\nfunction isVisible(el: HTMLElement): boolean {\r\n  // Quick visibility heuristic\r\n  const style = window.getComputedStyle(el);\r\n  if (style.visibility === 'hidden' || style.display === 'none') return false;\r\n\r\n  // Hidden via details element\r\n  const details = el.closest('details');\r\n  if (details && !details.open && !details.querySelector('summary')?.contains(el)) return false;\r\n\r\n  // Not in document or clipped out\r\n  if (!el.ownerDocument || !el.getClientRects().length) {\r\n    // Fallback: if it's the root of the trap, allow focusing via tabindex -1 later\r\n    return !!el.ownerDocument;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction getTabIndex(el: HTMLElement): number {\r\n  const attr = el.getAttribute('tabindex');\r\n  if (attr !== null) {\r\n    const n = Number(attr);\r\n    return Number.isNaN(n) ? 0 : n;\r\n  }\r\n  // Certain elements are naturally tabbable\r\n  const tag = el.tagName.toLowerCase();\r\n  const naturallyTabbable = /^(a|area|input|select|textarea|button|summary)$/i.test(tag);\r\n  if (naturallyTabbable) {\r\n    // anchors without href are not tabbable\r\n    if ((tag === 'a' || tag === 'area') && !el.hasAttribute('href')) return -1;\r\n    return 0;\r\n  }\r\n  return -1;\r\n}\r\n\r\n/** Focus the first tabbable in root, or fallback element, or root (with temp tabindex). */\r\nexport function focusFirst(root: HTMLElement, fallback?: HTMLElement | null): void {\r\n  const tabbables = getTabbables(root);\r\n  const target = tabbables[0] || fallback || root;\r\n\r\n  // Ensure focusability if root is used\r\n  let removeTabIndex = false;\r\n  if (target === root && getTabIndex(root) < 0) {\r\n    root.setAttribute('tabindex', '-1');\r\n    removeTabIndex = true;\r\n  }\r\n\r\n  try {\r\n    target.focus({ preventScroll: true } as any);\r\n  } catch {\r\n    // ignore\r\n  } finally {\r\n    if (removeTabIndex) root.removeAttribute('tabindex');\r\n  }\r\n}\r\n\r\n/** Trap keyboard Tab/Shift+Tab inside the container. Returns { release() }. */\r\nexport function trapFocus(container: HTMLElement, opts?: TrapOptions): { release: () => void } {\r\n  const previouslyFocused = (document.activeElement as HTMLElement) || null;\r\n\r\n  // Initial focus\r\n  if (opts?.initialFocus) {\r\n    try { opts.initialFocus.focus({ preventScroll: true } as any); } catch {}\r\n  } else {\r\n    focusFirst(container, container);\r\n  }\r\n\r\n  const onKeyDown = (e: KeyboardEvent) => {\r\n    if (e.key !== 'Tab') return;\r\n    const tabbables = getTabbables(container);\r\n    if (tabbables.length === 0) {\r\n      // Keep focus on container\r\n      e.preventDefault();\r\n      focusFirst(container, container);\r\n      return;\r\n    }\r\n    const first = tabbables[0];\r\n    const last = tabbables[tabbables.length - 1];\r\n    const active = document.activeElement as HTMLElement | null;\r\n\r\n    if (e.shiftKey) {\r\n      if (!active || active === first || !container.contains(active)) {\r\n        e.preventDefault();\r\n        last.focus();\r\n      }\r\n    } else {\r\n      if (!active || active === last || !container.contains(active)) {\r\n        e.preventDefault();\r\n        first.focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  document.addEventListener('keydown', onKeyDown, true);\r\n\r\n  const release = () => {\r\n    document.removeEventListener('keydown', onKeyDown, true);\r\n    const restore = opts?.restoreFocus === undefined ? previouslyFocused : opts.restoreFocus;\r\n    if (restore && document.contains(restore)) {\r\n      try { restore.focus({ preventScroll: true } as any); } catch {}\r\n    }\r\n  };\r\n\r\n  return { release };\r\n}\r\n\r\n/**\r\n * Hide everything except the target from assistive tech by toggling aria-hidden.\r\n * Returns a restore() function that reverts previous values.\r\n */\r\nexport function ariaHideSiblings(target: HTMLElement): () => void {\r\n  const doc = target.ownerDocument || document;\r\n  const root = doc.body;\r\n  const stack: Array<{ el: Element; prev: string | null }> = [];\r\n\r\n  // Walk direct children of <body>\r\n  Array.from(root.children).forEach((el) => {\r\n    if (el === target || el.contains(target)) return; // keep target branch visible\r\n    const prev = el.getAttribute('aria-hidden');\r\n    stack.push({ el, prev });\r\n    el.setAttribute('aria-hidden', 'true');\r\n\r\n    // If supported, also mark inert to block focus/pointer\r\n    // try { (el as any).inert = true; } catch { /* inert may not exist */ }\r\n  });\r\n\r\n  return () => {\r\n    for (const { el, prev } of stack) {\r\n      if (prev === null) el.removeAttribute('aria-hidden'); else el.setAttribute('aria-hidden', prev);\r\n      // try { delete (el as any).inert; } catch { /* ignore */ }\r\n    }\r\n  };\r\n}\r\n\r\n/** Create (or return) a shared live region for toasts. */\r\nexport function createLiveRegion(kind: LiveKind = 'polite'): HTMLElement {\r\n  const id = kind === 'assertive' ? 'pj-live-assertive' : 'pj-live-polite';\r\n  const existing = document.getElementById(id) as HTMLElement | null;\r\n  if (existing) return existing;\r\n\r\n  const region = document.createElement('div');\r\n  region.id = id;\r\n  region.setAttribute('aria-live', kind);\r\n  region.setAttribute('role', kind === 'assertive' ? 'alert' : 'status');\r\n  region.setAttribute('aria-atomic', 'true');\r\n  region.style.position = 'absolute';\r\n  region.style.width = '1px';\r\n  region.style.height = '1px';\r\n  region.style.margin = '-1px';\r\n  region.style.border = '0';\r\n  region.style.padding = '0';\r\n  region.style.clip = 'rect(0 0 0 0)';\r\n  region.style.overflow = 'hidden';\r\n\r\n  document.body.appendChild(region);\r\n  return region;\r\n}\r\n","/**\r\n * PromptJS – modal-core.ts\r\n * Core modal dialog surface creation and management.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n */ \r\n\r\nimport { uid } from \"./utils\";\r\nimport { config } from \"./config\";\r\nimport { manager } from \"./manager\";\r\nimport { trapFocus, ariaHideSiblings } from \"./a11y\";\r\nimport type {\r\n  ModalInstance,\r\n  ModalDraggable,\r\n  ModalConcurrency,\r\n  NotifyKind,\r\n  ButtonDef,\r\n} from \"./types\";\r\n\r\n/**\r\n * Use longhand translate when available so dragging composes with animations.\r\n * Optionally add this CSS once if you want a robust fallback:\r\n * .pj-modal{ --pj-dx:0px; --pj-dy:0px; transform: translate(var(--pj-dx),var(--pj-dy)); }\r\n */\r\nfunction setDragOffset(el: HTMLElement, x: number, y: number) {\r\n  if (\"translate\" in (el.style as any))\r\n    (el.style as any).translate = `${x}px ${y}px`;\r\n  else {\r\n    el.style.setProperty(\"--pj-dx\", `${x}px`);\r\n    el.style.setProperty(\"--pj-dy\", `${y}px`);\r\n  }\r\n}\r\n\r\ntype DragResolved = {\r\n  axis: \"x\" | \"y\" | \"both\";\r\n  withinViewport: boolean;\r\n  cursor: string | null; // null => don't set\r\n};\r\n\r\nfunction enableDragging(\r\n  surfaceEl: HTMLDivElement,\r\n  handleEl: HTMLElement,\r\n  spec: DragResolved\r\n) {\r\n  let startX = 0,\r\n    startY = 0,\r\n    baseX = 0,\r\n    baseY = 0;\r\n  let moving = false;\r\n\r\n  const point = (e: MouseEvent | TouchEvent) => {\r\n    const t = (e as TouchEvent).touches?.[0] ?? (e as MouseEvent);\r\n    return { x: t.clientX, y: t.clientY };\r\n  };\r\n\r\n  const readTranslate = () => {\r\n    const t = surfaceEl.style.translate || \"\";\r\n    const m = t.match(/(-?\\d+(?:\\.\\d+)?)px\\s+(-?\\d+(?:\\.\\d+)?)px/);\r\n    if (m) return { x: parseFloat(m[1]), y: parseFloat(m[2]) };\r\n    const dx =\r\n      parseFloat(getComputedStyle(surfaceEl).getPropertyValue(\"--pj-dx\")) || 0;\r\n    const dy =\r\n      parseFloat(getComputedStyle(surfaceEl).getPropertyValue(\"--pj-dy\")) || 0;\r\n    return { x: dx, y: dy };\r\n  };\r\n\r\n  const clampViewport = (nx: number, ny: number) => {\r\n    if (!spec.withinViewport) return { x: nx, y: ny };\r\n    const vw = document.documentElement.clientWidth;\r\n    const vh = document.documentElement.clientHeight;\r\n    const r = surfaceEl.getBoundingClientRect();\r\n    const minX = -r.left + r.width * -0.9;\r\n    const maxX = vw - r.right + r.width * 0.9;\r\n    const minY = -r.top + r.height * -0.9;\r\n    const maxY = vh - r.bottom + r.height * 0.9;\r\n    return {\r\n      x: Math.min(Math.max(nx, minX), maxX),\r\n      y: Math.min(Math.max(ny, minY), maxY),\r\n    };\r\n  };\r\n\r\n  const onMove = (e: MouseEvent | TouchEvent) => {\r\n    if (!moving) return;\r\n    e.preventDefault();\r\n    const p = point(e);\r\n    let nx = baseX + (spec.axis === \"y\" ? 0 : p.x - startX);\r\n    let ny = baseY + (spec.axis === \"x\" ? 0 : p.y - startY);\r\n    ({ x: nx, y: ny } = clampViewport(nx, ny));\r\n    setDragOffset(surfaceEl, nx, ny);\r\n  };\r\n\r\n  const onUp = () => {\r\n    moving = false;\r\n    document.removeEventListener(\"mousemove\", onMove, true);\r\n    document.removeEventListener(\"touchmove\", onMove, true);\r\n    handleEl.style.cursor = spec.cursor || \"grab\";\r\n  };\r\n\r\n  const onDown = (e: MouseEvent | TouchEvent) => {\r\n    if (e instanceof MouseEvent && e.button !== 0) return;\r\n    e.preventDefault();\r\n    const p = point(e);\r\n    startX = p.x;\r\n    startY = p.y;\r\n    const t = readTranslate();\r\n    baseX = t.x;\r\n    baseY = t.y;\r\n    moving = true;\r\n    handleEl.style.cursor = spec.cursor || \"grabbing\";\r\n    document.addEventListener(\"mousemove\", onMove, true);\r\n    document.addEventListener(\"mouseup\", onUp, { once: true, capture: true });\r\n    document.addEventListener(\"touchmove\", onMove, {\r\n      passive: false,\r\n      capture: true,\r\n    });\r\n    document.addEventListener(\"touchend\", onUp, { once: true, capture: true });\r\n    surfaceEl.classList.add(\"pj-modal-moved\");\r\n  };\r\n\r\n  handleEl.addEventListener(\"mousedown\", onDown);\r\n  handleEl.addEventListener(\"touchstart\", onDown, { passive: false });\r\n\r\n  return () => {\r\n    handleEl.removeEventListener(\"mousedown\", onDown);\r\n    handleEl.removeEventListener(\"touchstart\", onDown);\r\n  };\r\n}\r\n\r\n/* ---------------- Core contracts ---------------- */\r\n\r\nexport type CoreChrome = {\r\n  windowed: boolean;\r\n  bare?: boolean;\r\n  size?:\r\n    | \"sm\"\r\n    | \"md\"\r\n    | \"lg\"\r\n    | \"fit\"\r\n    | { w?: number | string; h?: number | string };\r\n  surfaceClass?: string;\r\n  contentClass?: string;\r\n};\r\n\r\nexport type CoreBehavior = {\r\n  animate?: boolean;\r\n  closeOnEsc?: boolean;\r\n  closeOnBackdrop?: boolean;\r\n  trapFocus?: boolean;\r\n  ariaLabel?: string;\r\n  draggable?: ModalDraggable;\r\n  onOpen?: (inst: ModalInstance) => void;\r\n  onClose?: (result?: unknown) => void;\r\n  concurrency?: ModalConcurrency;\r\n};\r\n\r\nexport type CoreVisuals = {\r\n  surfaceAlpha?: number;\r\n  dialogBlurPx?: number; // blur on modal surface when translucent\r\n  backdropBlurPx?: number; // blur on overlay\r\n  kind?: NotifyKind;\r\n};\r\n\r\nexport type CoreOptions = CoreChrome & CoreBehavior & CoreVisuals;\r\n\r\nexport type CoreRenderers = {\r\n  renderHeader?: (inst: ModalInstance, headerHost: HTMLDivElement) => void;\r\n  renderBody: (\r\n    inst: ModalInstance,\r\n    bodyHost: HTMLDivElement,\r\n    setContentEl: (el: HTMLElement) => void\r\n  ) => void;\r\n  renderFooter?: (inst: ModalInstance, footerHost: HTMLDivElement) => void;\r\n  setUpdater?: (\r\n    inst: ModalInstance,\r\n    refs: {\r\n      header?: HTMLDivElement | null;\r\n      body: HTMLDivElement;\r\n      footer?: HTMLDivElement | null;\r\n      setContentEl: (el: HTMLElement) => void;\r\n    }\r\n  ) => void;\r\n};\r\n\r\nexport function createSurface(\r\n  core: CoreOptions,\r\n  r: CoreRenderers\r\n): ModalInstance {\r\n  const id = uid(\"modal\");\r\n  const cfg = config.get();\r\n  const animEnabled = core.animate ?? cfg.animation?.enable ?? true;\r\n  const animDur = cfg.animation?.durationMs ?? 180;\r\n  const animEase = cfg.animation?.easing ?? \"ease\";\r\n  const overlayFade = cfg.overlay?.fade ?? true;\r\n\r\n  // roots\r\n  manager.ensureRoots();\r\n\r\n  // DOM refs\r\n  let overlay!: HTMLDivElement;\r\n  let modal!: HTMLDivElement;\r\n  let headerEl: HTMLDivElement | null = null;\r\n  let bodyEl!: HTMLDivElement;\r\n  let footerEl: HTMLDivElement | null = null;\r\n\r\n  // lifecycle\r\n  let isClosing = false;\r\n  let releaseTrap: (() => void) | null = null;\r\n  let restoreAria: (() => void) | null = null;\r\n  let cleanupDrag: (() => void) | null = null;\r\n\r\n  // instance handles\r\n  let _el!: HTMLDivElement;\r\n  let _contentEl!: HTMLElement;\r\n  const instance: ModalInstance = {\r\n    id,\r\n    close: (result?: unknown) => close(result),\r\n    update: () => {\r\n      /* Dialog-only update is implemented in modal.ts via wrapper */\r\n    },\r\n    get el() {\r\n      return _el;\r\n    },\r\n    get contentEl() {\r\n      return _contentEl;\r\n    },\r\n  };\r\n\r\n  let onEsc: ((e: KeyboardEvent) => void) | null = null;\r\n\r\n  const render = () => {\r\n    // overlay\r\n    overlay = document.createElement(\"div\");\r\n    overlay.className = \"pj-overlay\";\r\n    overlay.setAttribute(\"role\", \"presentation\");\r\n    const alpha = cfg.overlay?.surfaceAlpha ?? 0.6;\r\n    overlay.style.setProperty(\"--pj-overlay-alpha\", String(alpha));\r\n    const overlayBlur = core.backdropBlurPx ?? cfg.overlay?.backdropBlurPx ?? 0;\r\n    if (overlayBlur > 0) {\r\n      overlay.classList.add(\"pj-blur\");\r\n      overlay.style.setProperty(\"--pj-overlay-blur\", `${overlayBlur}px`);\r\n    }\r\n\r\n    // modal surface\r\n    modal = document.createElement(\"div\");\r\n    modal.className = core.windowed ? \"pj-modal\" : \"pj-modal-no-window\";\r\n    if (core.bare)\r\n      modal.classList.add(\r\n        \"pad-none\"\r\n      ); /* Add no padding if bare, content can add margin or padding */\r\n\r\n    modal.setAttribute(\"role\", \"dialog\");\r\n    modal.setAttribute(\"aria-modal\", \"true\");\r\n    if (core.ariaLabel) modal.setAttribute(\"aria-label\", core.ariaLabel);\r\n    if (core.kind) modal.classList.add(`pj-kind-${core.kind}`);\r\n    // modal.classList.add(core.windowed ? \"windowed\" : \"nonwindowed\");\r\n\r\n    // visuals (alpha + surface blur)\r\n    const surfaceAlpha = core.surfaceAlpha ?? cfg.modal.surfaceAlpha ?? 1;\r\n    const surfaceBlur = core.dialogBlurPx ?? cfg.modal.dialogBlurPx ?? 0;\r\n    modal.style.setProperty(\"--pj-modal-alpha\", String(surfaceAlpha));\r\n    if (surfaceAlpha < 1 && surfaceBlur > 0) {\r\n      modal.classList.add(\"pj-modal-translucent\");\r\n      modal.style.setProperty(\"--pj-modal-blur\", `${surfaceBlur}px`);\r\n    }\r\n\r\n    // size presets when windowed and string size\r\n    const sz = core.size ?? \"md\";\r\n    if (core.windowed && typeof sz === \"string\") {\r\n      modal.classList.add(`size-${sz}`);\r\n    }\r\n\r\n    // header/body/footer hosts\r\n    if (r.renderHeader) {\r\n      headerEl = document.createElement(\"div\");\r\n      headerEl.className = \"pj-modal-header\";\r\n      modal.appendChild(headerEl);\r\n    }\r\n\r\n    bodyEl = document.createElement(\"div\");\r\n    bodyEl.className = \"pj-modal-content\";\r\n    if (core.bare)\r\n      bodyEl.classList.add(\r\n        \"pad-none\"\r\n      ); /* Add no padding if bare, content can add margin or padding */\r\n    if (core.contentClass) bodyEl.classList.add(core.contentClass);\r\n    modal.appendChild(bodyEl);\r\n\r\n    if (r.renderFooter) {\r\n      footerEl = document.createElement(\"div\");\r\n      footerEl.className = \"pj-modal-footer\";\r\n      modal.appendChild(footerEl);\r\n    }\r\n\r\n    if (core.surfaceClass) modal.classList.add(core.surfaceClass);\r\n\r\n    overlay.appendChild(modal);\r\n    manager.portal.appendChild(overlay);\r\n\r\n    // focus trap & aria hide\r\n    const initial = footerEl?.querySelector(\"button\") as HTMLElement | null;\r\n    if (core.trapFocus !== false) {\r\n      releaseTrap = trapFocus(modal, { initialFocus: initial }).release;\r\n    }\r\n    restoreAria = ariaHideSiblings(overlay);\r\n\r\n    // instance element handles\r\n    _el = modal;\r\n    _contentEl = bodyEl;\r\n\r\n    // renderers\r\n    if (r.renderHeader && headerEl) r.renderHeader(instance, headerEl);\r\n    r.renderBody(instance, bodyEl, (el) => {\r\n      _contentEl = el;\r\n    });\r\n    if (r.renderFooter && footerEl) r.renderFooter(instance, footerEl);\r\n    if (r.setUpdater) {\r\n      r.setUpdater(instance, {\r\n        header: headerEl,\r\n        body: bodyEl,\r\n        footer: footerEl,\r\n        setContentEl: (el) => {\r\n          _contentEl = el;\r\n        }, \r\n      });\r\n    }\r\n\r\n    // dragging\r\n    const drag = core.draggable;\r\n    const prefersCoarse =\r\n      typeof window !== \"undefined\" &&\r\n      window.matchMedia?.(\"(pointer: coarse)\").matches;\r\n    const isMobileUA = /Mobi|Android/i.test(navigator.userAgent);\r\n    const disableOnMobile =\r\n      typeof drag === \"object\" ? drag.disableOnMobile ?? true : true;\r\n\r\n    if (drag && !prefersCoarse && !(isMobileUA && disableOnMobile)) {\r\n      const spec = typeof drag === \"object\" ? drag : {};\r\n      const axis = spec.axis ?? \"both\";\r\n      const withinViewport = spec.withinViewport ?? true;\r\n      const cursor = spec.cursor ?? null;\r\n\r\n      // resolve handle: default header (if exists & windowed), else content/body\r\n      let handleEl: HTMLElement | null = null;\r\n      if (spec.handle instanceof HTMLElement) handleEl = spec.handle;\r\n      else if (typeof spec.handle === \"string\") {\r\n        if (spec.handle === \"header\") handleEl = headerEl ?? null;\r\n        else if (spec.handle === \"body\") handleEl = bodyEl;\r\n        else handleEl = modal.querySelector(spec.handle) as HTMLElement | null;\r\n      } else {\r\n        handleEl = core.windowed ? headerEl ?? modal : _contentEl ?? bodyEl;\r\n      }\r\n\r\n      if (handleEl) {\r\n        cleanupDrag = enableDragging(modal, handleEl, {\r\n          axis,\r\n          withinViewport,\r\n          cursor,\r\n        });\r\n        modal.classList.add(\"pj-modal-draggable\");\r\n        if (cursor) handleEl.style.cursor = cursor;\r\n      }\r\n    }\r\n\r\n    bind();\r\n    manager.scrollLock(true);\r\n\r\n    // open animations\r\n    if (animEnabled) {\r\n      if (overlayFade) {\r\n        overlay.classList.add(\"pj-overlay-in\");\r\n        overlay.style.setProperty(\"--pj-anim-duration\", `${animDur}ms`);\r\n        overlay.style.setProperty(\"--pj-anim-ease\", animEase);\r\n      }\r\n      modal.classList.add(\"pj-modal-in\");\r\n      modal.style.setProperty(\"--pj-anim-duration\", `${animDur}ms`);\r\n      modal.style.setProperty(\"--pj-anim-ease\", animEase);\r\n    }\r\n\r\n    core.onOpen?.(instance);\r\n  };\r\n\r\n  const bind = () => {\r\n    if (core.closeOnBackdrop ?? true) {\r\n      overlay.addEventListener(\"click\", (e) => {\r\n        if (e.target === overlay) close(\"backdrop\");\r\n      });\r\n    }\r\n    if (core.closeOnEsc ?? true) {\r\n      onEsc = (e: KeyboardEvent) => {\r\n        if (e.key === \"Escape\") {\r\n          e.stopPropagation();\r\n          close(\"esc\");\r\n          document.removeEventListener(\"keydown\", onEsc as any, true);\r\n        }\r\n      };\r\n      document.addEventListener(\"keydown\", onEsc, true);\r\n    }\r\n  };\r\n\r\n  const teardown = (result?: unknown) => {\r\n    overlay.remove();\r\n    manager.onClose();\r\n    manager.scrollLock(false);\r\n    try {\r\n      releaseTrap?.();\r\n    } catch {}\r\n    try {\r\n      restoreAria?.();\r\n    } catch {}\r\n    try {\r\n      cleanupDrag?.();\r\n    } catch {}\r\n    releaseTrap = restoreAria = cleanupDrag = null;\r\n    try {\r\n      document.removeEventListener(\"keydown\", onEsc as any, true);\r\n    } catch {}\r\n    core.onClose?.(result);\r\n  };\r\n\r\n  const close = (result?: unknown) => {\r\n    if (isClosing) return;\r\n    isClosing = true;\r\n\r\n    if (!animEnabled) {\r\n      teardown(result);\r\n      return;\r\n    }\r\n\r\n    modal.classList.remove(\"pj-modal-in\");\r\n    modal.classList.add(\"pj-modal-out\");\r\n    modal.style.setProperty(\"--pj-anim-duration\", `${animDur}ms`);\r\n    modal.style.setProperty(\"--pj-anim-ease\", animEase);\r\n\r\n    if (overlayFade) {\r\n      overlay.classList.remove(\"pj-overlay-in\");\r\n      overlay.classList.add(\"pj-overlay-out\");\r\n      overlay.style.setProperty(\"--pj-anim-duration\", `${animDur}ms`);\r\n      overlay.style.setProperty(\"--pj-anim-ease\", animEase);\r\n    }\r\n\r\n    let doneModal = false;\r\n    let doneOverlay = !overlayFade;\r\n    const tryDone = () => {\r\n      if (doneModal && doneOverlay) teardown(result);\r\n    };\r\n\r\n    const onModalEnd = () => {\r\n      doneModal = true;\r\n      modal.removeEventListener(\"animationend\", onModalEnd);\r\n      tryDone();\r\n    };\r\n    modal.addEventListener(\"animationend\", onModalEnd);\r\n\r\n    if (overlayFade) {\r\n      const onOverlayEnd = () => {\r\n        doneOverlay = true;\r\n        overlay.removeEventListener(\"animationend\", onOverlayEnd);\r\n        tryDone();\r\n      };\r\n      overlay.addEventListener(\"animationend\", onOverlayEnd);\r\n    }\r\n\r\n    window.setTimeout(tryDone, (animDur ?? 0) + 50);\r\n  };\r\n\r\n  // Orchestrate via manager (queue/reject handled there already)\r\n  manager.open(() => render());\r\n\r\n  return instance;\r\n}\r\n","/**\r\n * PromptJS – toast.ts\r\n * Edge notifications with per-position slots, behavior (stack|queue|replace),\r\n * enter/exit animations, and a timeout progress cue.\r\n *\r\n * Uses Manager's toast slots/queues; does not affect modals.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n */\r\n\r\nimport { manager } from \"./manager\";\r\nimport { config } from \"./config\";\r\nimport { sanitize } from \"./sanitize\";\r\nimport type {\r\n  ToastOptions,\r\n  ToastPosition,\r\n  ToastBehavior,\r\n  ToastAnimations,\r\n  ToastAnimSpec,\r\n} from \"./types\";\r\n\r\ntype Phase = \"enter\" | \"exit\";\r\n\r\nfunction px(v: number | string): string {\r\n  return typeof v === \"number\" ? `${v}px` : v;\r\n}\r\n\r\nfunction prefersReducedMotion(): boolean {\r\n  return (\r\n    typeof window !== \"undefined\" &&\r\n    !!window.matchMedia &&\r\n    window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches\r\n  );\r\n}\r\n\r\nfunction removeMatchingClasses(el: Element, re: RegExp) {\r\n  el.classList.forEach((cls) => {\r\n    if (re.test(cls)) el.classList.remove(cls);\r\n  });\r\n}\r\n\r\n/** Wait for a CSS animation to end; falls back to a timer. Returns a canceller. */\r\nfunction onceAnimationEnd(\r\n  el: HTMLElement,\r\n  expectedMs: number,\r\n  done: () => void\r\n): () => void {\r\n  let called = false;\r\n  const onEnd = (ev: AnimationEvent) => {\r\n    if (ev.target === el && !called) {\r\n      called = true;\r\n      el.removeEventListener(\"animationend\", onEnd);\r\n      clearTimeout(timer);\r\n      done();\r\n    }\r\n  };\r\n  const timer = window.setTimeout(() => {\r\n    if (!called) {\r\n      called = true;\r\n      el.removeEventListener(\"animationend\", onEnd);\r\n      done();\r\n    }\r\n  }, Math.max(0, expectedMs) + 50);\r\n  el.addEventListener(\"animationend\", onEnd);\r\n  return () => {\r\n    if (!called) {\r\n      called = true;\r\n      clearTimeout(timer);\r\n      el.removeEventListener(\"animationend\", onEnd);\r\n      done();\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Resolve an animation spec against a position:\r\n * - direction: 'auto' becomes a concrete edge\r\n * - distance: 'edge' becomes '120%' (off-screen enough)\r\n * - duration/easing: from spec or global config.animation\r\n */\r\nfunction resolveAnim(\r\n  position: ToastPosition,\r\n  phase: Phase,\r\n  spec?: ToastAnimSpec\r\n): {\r\n  preset: \"fade\" | \"slide\" | \"scale\";\r\n  direction?: \"up\" | \"down\" | \"left\" | \"right\";\r\n  distance?: string;\r\n  durationMs: number;\r\n  easing: string;\r\n} {\r\n  const cfg = config.get();\r\n  const baseDur = cfg.animation?.durationMs ?? 180;\r\n  const baseEase = cfg.animation?.easing ?? \"ease\";\r\n\r\n  if (!spec) {\r\n    const def =\r\n      phase === \"enter\"\r\n        ? {\r\n            preset: \"slide\" as \"slide\",\r\n            direction: autoDirection(position, phase),\r\n            distance: defaultDistance(position, phase),\r\n          }\r\n        : { preset: \"fade\" as \"fade\" };\r\n    return {\r\n      preset: def.preset,\r\n      direction: (def as any).direction,\r\n      distance: (def as any).distance,\r\n      durationMs: baseDur,\r\n      easing: baseEase,\r\n    };\r\n  }\r\n\r\n  const preset = spec.preset;\r\n  const dir =\r\n    preset === \"slide\"\r\n      ? spec.direction && spec.direction !== \"auto\"\r\n        ? spec.direction\r\n        : autoDirection(position, phase)\r\n      : undefined;\r\n\r\n  let distance: string | undefined;\r\n  if (preset === \"slide\") {\r\n    if (spec.distance === \"edge\" || spec.distance === undefined) {\r\n      distance = defaultDistance(position, phase);\r\n    } else {\r\n      distance = px(spec.distance);\r\n    }\r\n  }\r\n\r\n  return {\r\n    preset,\r\n    direction: dir,\r\n    distance,\r\n    durationMs: spec.durationMs ?? baseDur,\r\n    easing: spec.easing ?? baseEase,\r\n  };\r\n}\r\n\r\n/** Direction denotes the edge the toast comes from (enter) or goes to (exit). */\r\nfunction autoDirection(\r\n  position: ToastPosition,\r\n  phase: Phase\r\n): \"up\" | \"down\" | \"left\" | \"right\" {\r\n  switch (position) {\r\n    case \"top-center\":\r\n      return phase === \"enter\" ? \"up\" : \"up\";\r\n    case \"bottom-center\":\r\n      return phase === \"enter\" ? \"down\" : \"down\";\r\n    case \"top-left\":\r\n    case \"bottom-left\":\r\n      return \"left\";\r\n    case \"top-right\":\r\n    case \"bottom-right\":\r\n      return \"right\";\r\n  }\r\n}\r\n\r\n/** Default movement distance: centers use subtle on enter and off-screen on exit; corners off-screen both. */\r\nfunction defaultDistance(position: ToastPosition, phase: Phase): string {\r\n  const offscreen = \"120%\";\r\n  const subtle = \"16px\";\r\n  if (position === \"top-center\") return phase === \"enter\" ? subtle : offscreen;\r\n  if (position === \"bottom-center\")\r\n    return phase === \"enter\" ? subtle : offscreen;\r\n  return offscreen;\r\n}\r\n\r\nfunction applyAnim(\r\n  el: HTMLElement,\r\n  phase: Phase,\r\n  resolved: ReturnType<typeof resolveAnim>\r\n) {\r\n  // Always set base vars for consistency\r\n  el.style.setProperty(\"--pj-anim-duration\", `${resolved.durationMs}ms`);\r\n  el.style.setProperty(\"--pj-anim-ease\", resolved.easing);\r\n\r\n  if (resolved.preset === \"fade\") {\r\n    el.classList.add(phase === \"enter\" ? \"pj-enter-fade\" : \"pj-exit-fade\");\r\n    return;\r\n  }\r\n\r\n  if (resolved.preset === \"scale\") {\r\n    el.classList.add(phase === \"enter\" ? \"pj-enter-scale\" : \"pj-exit-scale\");\r\n    return;\r\n  }\r\n\r\n  if (resolved.preset === \"slide\" && resolved.direction) {\r\n    if (phase === \"enter\" && resolved.distance) {\r\n      // Only enter uses the variable distance (exit generally heads to edge)\r\n      el.style.setProperty(\"--pj-enter-distance\", resolved.distance);\r\n    }\r\n    const cls = `pj-${phase}-slide-${resolved.direction}`;\r\n    el.classList.add(cls);\r\n  }\r\n}\r\n\r\nfunction addTimeoutCue(\r\n  el: HTMLElement,\r\n  animations: ToastAnimations,\r\n  timeoutMs?: number\r\n) {\r\n  if (!timeoutMs || timeoutMs <= 0) return;\r\n\r\n  const cue = animations.timeoutCue || {};\r\n  const show = cue.show !== false;\r\n  if (!show) return;\r\n\r\n  const pos = cue.position || \"bottom\";\r\n  const thickness = cue.thicknessPx ?? 3;\r\n\r\n  // Cover mode\r\n  if (pos === \"cover\") {\r\n    const cover = document.createElement(\"div\");\r\n    cover.className = \"pj-timeout-cover\";\r\n    cover.style.setProperty(\"--pj-timeout-ms\", `${timeoutMs}ms`);\r\n    if (cue.direction === \"shrink\") cover.style.animationDirection = \"reverse\";\r\n    el.appendChild(cover);\r\n    return;\r\n  }\r\n\r\n  // Edge bar mode\r\n  const bar = document.createElement(\"div\");\r\n  bar.className = `pj-timeout-bar pj-${pos}`;\r\n  bar.style.setProperty(\"--pj-timeout-ms\", `${timeoutMs}ms`);\r\n  if (pos === \"top\" || pos === \"bottom\") {\r\n    bar.style.height = `${thickness}px`;\r\n  } else {\r\n    bar.style.width = `${thickness}px`;\r\n  }\r\n  if (cue.direction === \"shrink\") bar.style.animationDirection = \"reverse\";\r\n  el.appendChild(bar);\r\n}\r\n\r\n/* ------------------------------------------------------------------\r\n   Container collapse (post-exit) to avoid stack \"jump\"\r\n-------------------------------------------------------------------*/\r\n\r\nfunction collapseAndRemove(\r\n  container: HTMLElement,\r\n  position: ToastPosition,\r\n  durationMs: number,\r\n  easing: string\r\n) {\r\n  // If animations disabled or reduced motion, just remove container\r\n  if (\r\n    prefersReducedMotion() ||\r\n    durationMs <= 0 ||\r\n    !config.get().animation?.enable\r\n  ) {\r\n    container.remove();\r\n    manager.onToastRemoved(position);\r\n    return;\r\n  }\r\n\r\n  const startH = container.offsetHeight;\r\n  container.style.overflow = \"hidden\";\r\n  container.style.height = `${startH}px`;\r\n  container.style.marginTop = getComputedStyle(container).marginTop;\r\n  container.style.marginBottom = getComputedStyle(container).marginBottom;\r\n  container.style.paddingTop = getComputedStyle(container).paddingTop;\r\n  container.style.paddingBottom = getComputedStyle(container).paddingBottom;\r\n\r\n  // Force reflow to lock the starting values\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\r\n  (container as any).offsetWidth;\r\n\r\n  container.style.transition = [\r\n    `height ${durationMs}ms ${easing}`,\r\n    `margin ${durationMs}ms ${easing}`,\r\n    `padding ${durationMs}ms ${easing}`,\r\n    `opacity ${durationMs}ms ${easing}`,\r\n  ].join(\", \");\r\n  container.style.height = \"0px\";\r\n  container.style.marginTop = \"0px\";\r\n  container.style.marginBottom = \"0px\";\r\n  container.style.paddingTop = \"0px\";\r\n  container.style.paddingBottom = \"0px\";\r\n  container.style.opacity = \"0\";\r\n\r\n  const done = () => {\r\n    container.removeEventListener(\"transitionend\", done);\r\n    container.remove();\r\n    manager.onToastRemoved(position);\r\n  };\r\n  container.addEventListener(\"transitionend\", done);\r\n  // Safety in case transitionend is swallowed\r\n  window.setTimeout(done, durationMs + 50);\r\n}\r\n\r\n/* ------------------------------------------------------------------\r\n   Unified exit (timeout & button) -> then container collapse\r\n-------------------------------------------------------------------*/\r\n\r\nfunction beginExit(\r\n  toastEl: HTMLElement,\r\n  container: HTMLElement,\r\n  position: ToastPosition,\r\n  userExitSpec?: ToastAnimSpec\r\n) {\r\n  if ((toastEl as any)._pjExiting) return;\r\n  (toastEl as any)._pjExiting = true;\r\n\r\n  // Remove any lingering enter-* so exit can trigger\r\n  removeMatchingClasses(toastEl, /^pj-enter-/);\r\n\r\n  const cfg = config.get();\r\n  const animEnabled = !!cfg.animation?.enable;\r\n  const exitResolved = resolveAnim(\r\n    position,\r\n    \"exit\",\r\n    userExitSpec ?? cfg.toast.animations.exit\r\n  );\r\n\r\n  if (!animEnabled || prefersReducedMotion() || exitResolved.durationMs <= 0) {\r\n    // No motion: collapse container immediately\r\n    collapseAndRemove(container, position, 0, exitResolved.easing);\r\n    return;\r\n  }\r\n\r\n  // Apply exit animation to the toast element\r\n  applyAnim(toastEl, \"exit\", exitResolved);\r\n\r\n  // Force a reflow so class changes are recognized as a new animation\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\r\n  (toastEl as any).offsetWidth;\r\n\r\n  // Wait for exit anim to complete, then collapse the container\r\n  onceAnimationEnd(toastEl, exitResolved.durationMs, () => {\r\n    collapseAndRemove(\r\n      container,\r\n      position,\r\n      exitResolved.durationMs,\r\n      exitResolved.easing\r\n    );\r\n  });\r\n}\r\n\r\n/* ------------------------------------------------------------\r\n   Public API\r\n-------------------------------------------------------------*/\r\n\r\nexport function toast(opts: ToastOptions): { dismiss: () => void } {\r\n  manager.ensureRoots();\r\n\r\n  const cfg = config.get();\r\n  const pos: ToastPosition = opts.position || cfg.toast.defaultPosition;\r\n  const behavior: ToastBehavior = opts.behavior || cfg.toast.behavior;\r\n  const maxVisible = opts.maxVisible || cfg.toast.maxVisible;\r\n\r\n  const timeoutMs = opts.timeoutMs ?? cfg.toast.defaultTimeoutMs;\r\n\r\n  // ── Container (floats in the slot; collapses after exit) ─────────\r\n  const container = document.createElement(\"div\");\r\n  container.className = \"pj-toast-item\";\r\n\r\n  // Base toast element (animates in/out inside the container)\r\n  const el = document.createElement(\"div\");\r\n  el.className = `pj-toast pj-${opts.kind || \"neutral\"} ${\r\n    opts.dismissible ?? cfg.toast.defaultDismissible ? \"dismissible\" : \"\"\r\n  }`;\r\n  el.setAttribute(\"role\", \"status\");\r\n  el.setAttribute(\"aria-live\", \"polite\");\r\n\r\n  // Title (optional)\r\n  let contentContainer = el;\r\n  let titleId: string | undefined;\r\n  if (opts.title) {\r\n    const h = document.createElement(\"div\");\r\n    h.className = \"pj-toast-title\";\r\n    h.innerHTML = sanitize(opts.title);\r\n    titleId = `pj-title-${Math.random().toString(36).slice(2, 9)}`;\r\n    h.id = titleId;\r\n    el.appendChild(h);\r\n    el.classList.add(\"has-title\");\r\n\r\n    // Wrap body+actions in a container for layout, body and actions appear side by side\r\n    contentContainer = document.createElement(\"div\");\r\n    contentContainer.style.cssText = \"display: flex; align-items: center; gap: 6px;\";\r\n    el.appendChild(contentContainer);\r\n  }\r\n\r\n  // Content\r\n  const body = document.createElement(\"div\");\r\n  body.className = \"pj-toast-body\";\r\n  body.innerHTML = sanitize(opts.message);\r\n  const bodyId = `pj-body-${Math.random().toString(36).slice(2, 9)}`;\r\n  body.id = bodyId;\r\n  contentContainer.appendChild(body);\r\n\r\n  // ARIA: prefer labelled-by (title) + described-by (body) if available\r\n  if (titleId) {\r\n    el.setAttribute(\"aria-labelledby\", titleId);\r\n    el.setAttribute(\"aria-describedby\", bodyId);\r\n  }\r\n\r\n  // Actions (optional)\r\n  if (opts.actions?.length) {\r\n    const bar = document.createElement(\"div\");\r\n    bar.className = \"pj-toast-actions\";\r\n    for (const a of opts.actions) {\r\n      const btn = document.createElement(\"button\");\r\n      btn.className = \"pj-toast-btn ghost\";\r\n      btn.textContent = a.text;\r\n      // Clicking any action also dismisses the toast\r\n      btn.addEventListener(\"click\", () =>\r\n        beginExit(el, container, pos, opts.animations?.exit)\r\n      );\r\n      btn.addEventListener(\"click\", () => {\r\n        try {\r\n          a.onClick?.();\r\n        } catch {}\r\n      });\r\n      bar.appendChild(btn);\r\n    }\r\n    contentContainer.appendChild(bar);\r\n  }\r\n\r\n  // Dismiss button\r\n  const dismissible = opts.dismissible ?? cfg.toast.defaultDismissible;\r\n  if (dismissible) {\r\n    const x = document.createElement(\"button\");\r\n    x.className = \"pj-toast-close\";\r\n    x.setAttribute(\"aria-label\", cfg.i18n.dismiss);\r\n    x.innerHTML =\r\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" ' +\r\n      'fill=\"none\" stroke=\"currentColor\" stroke-width=\"4\" aria-hidden=\"true\">' +\r\n      '<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\"/></svg>';\r\n    x.addEventListener(\"click\", () =>\r\n      beginExit(el, container, pos, opts.animations?.exit)\r\n    );\r\n    el.appendChild(x);\r\n  }\r\n\r\n  // Timeout auto-dismiss and visual cue\r\n  let timer: number | undefined;\r\n  if (timeoutMs && timeoutMs > 0) {\r\n    addTimeoutCue(el, opts.animations || cfg.toast.animations, timeoutMs);\r\n    timer = window.setTimeout(\r\n      () => beginExit(el, container, pos, opts.animations?.exit),\r\n      timeoutMs\r\n    );\r\n  }\r\n\r\n  // Enter animation on the toast element\r\n  const enterResolved = resolveAnim(\r\n    pos,\r\n    \"enter\",\r\n    (opts.animations && opts.animations.enter) || cfg.toast.animations.enter\r\n  );\r\n  const animEnabled = !!cfg.animation?.enable;\r\n\r\n  if (!prefersReducedMotion() && animEnabled && enterResolved.durationMs > 0) {\r\n    applyAnim(el, \"enter\", enterResolved);\r\n    // Clean enter classes after they complete, so exit always re-triggers\r\n    onceAnimationEnd(el, enterResolved.durationMs, () => {\r\n      removeMatchingClasses(el, /^pj-enter-/);\r\n    });\r\n  }\r\n\r\n  // Compose container\r\n  container.appendChild(el);\r\n\r\n  // Mount through Manager (container is the unit in the slot)\r\n  manager.showToast(container, pos, behavior, maxVisible);\r\n\r\n  // Controller\r\n  return {\r\n    dismiss: () => {\r\n      if (timer) window.clearTimeout(timer);\r\n      beginExit(el, container, pos, opts.animations?.exit);\r\n    },\r\n  };\r\n}\r\n\r\n// Temporary alias to ease migration; document toast() as the primary API\r\nexport const notify = toast;\r\n","/**\r\n * PromptJS – dialogs.ts\r\n * Promise-based dialogs built on the modal primitive.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * APIs:\r\n *   - question(opts): fully configurable buttons; resolves { id } of the chosen action\r\n *   - confirm(message, opts?): convenience wrapper resolving boolean\r\n *   - alert(message, opts?): convenience wrapper that resolves on acknowledge\r\n *   - prompt(message, defaultValue?, opts?): convenience wrapper for text input\r\n *\r\n * Features:\r\n *   - All dialogs support optional title via opts.title\r\n *   - question() supports onDismissal for handling ESC/backdrop/close button\r\n *   - Uses modal button plumbing; no direct DOM markup required by callers\r\n */\r\n\r\nimport { open } from './modal';\r\nimport { config } from './config';\r\nimport type { QuestionOptions, ConfirmOptions, AlertOptions } from './types';\r\n\r\nexport async function question(opts: QuestionOptions): Promise<{ id: string }> {\r\n  const { message, buttons, onDismissal, title, ...modalOpts } = opts;\r\n  \r\n  // Validation\r\n  if (!buttons || buttons.length === 0) {\r\n    throw new Error('[PromptJS] question() requires at least one button');\r\n  }\r\n  \r\n  return new Promise((resolve) => {\r\n    const m = open({\r\n      ...modalOpts,\r\n      title,\r\n      content: message,\r\n      buttons: buttons.map(b => ({\r\n        ...b,\r\n        closeOnClick: true,\r\n        onClick: () => resolve({ id: b.id }),\r\n      })),\r\n      onClose: (r) => {\r\n        // Handle dismissal (ESC, backdrop, close button)\r\n        // If onDismissal is not provided, modal won't resolve on dismissal\r\n        // User must click a button to get a response\r\n        if (['esc', 'backdrop', 'close'].includes(r as string) && onDismissal) {\r\n          resolve({ id: onDismissal });\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nexport async function confirm(message: string, opts?: ConfirmOptions): Promise<boolean> {\r\n  const buttons: Array<{ id: string; text: string; variant: 'primary'|'neutral'|'danger' }> = [\r\n    { id: 'yes', text: opts?.yesText ?? 'Yes', variant: 'primary' },\r\n    { id: 'no', text: opts?.noText ?? 'No', variant: 'neutral' },\r\n  ];\r\n  \r\n  if (opts?.includeCancel) {\r\n    buttons.push({ id: 'cancel', text: opts?.cancelText ?? 'Cancel', variant: 'neutral' });\r\n  }\r\n\r\n  const { id } = await question({\r\n    ...opts,\r\n    title: opts?.title,\r\n    message,\r\n    buttons,\r\n    onDismissal: 'cancel',  // Dismissal always maps to 'cancel' (returns false)\r\n  });\r\n  \r\n  return id === 'yes';\r\n}\r\n\r\nexport async function alert(message: string, opts?: AlertOptions): Promise<void> {\r\n  await new Promise<void>((resolve)=> {\r\n    open({\r\n      ...opts,\r\n      title: opts?.title,\r\n      content: message,\r\n      buttons: [{ \r\n        id:'ok', \r\n        text: opts?.okText ?? config.get().i18n.ok, \r\n        variant:'primary', \r\n        onClick: ()=>resolve() \r\n      }],\r\n      closeOnEsc: true,\r\n      closeOnBackdrop: true,\r\n      onClose: () => resolve(), // Resolve on any dismissal (ESC, backdrop, close button)\r\n    });\r\n  });\r\n}\r\n\r\nexport async function prompt(\r\n  message: string,\r\n  defaultValue?: string,\r\n  opts?: import('./types').PromptOptions\r\n): Promise<string | null> {\r\n  return new Promise((resolve) => {\r\n    let inputValue = defaultValue ?? '';\r\n    let errorEl: HTMLElement | null = null;\r\n    let resolved = false;\r\n\r\n    // Prevent double resolution\r\n    const safeResolve = (value: string | null) => {\r\n      if (!resolved) {\r\n        resolved = true;\r\n        resolve(value);\r\n      }\r\n    };\r\n\r\n    const validateInput = (value: string): string | null => {\r\n      const trimmed = value.trim();\r\n      \r\n      if (opts?.required && !trimmed) {\r\n        return 'This field is required';\r\n      }\r\n      if (opts?.minLength && trimmed.length < opts.minLength) {\r\n        return `Minimum ${opts.minLength} characters required`;\r\n      }\r\n      if (opts?.pattern) {\r\n        try {\r\n          const regex = new RegExp(opts.pattern);\r\n          if (!regex.test(value)) {\r\n            return 'Invalid format';\r\n          }\r\n        } catch (e) {\r\n          console.error('[PromptJS] Invalid regex pattern:', opts.pattern, e);\r\n          return 'Invalid format pattern';\r\n        }\r\n      }\r\n      if (opts?.validator) {\r\n        try {\r\n          const result = opts.validator(value);\r\n          if (result === false) return 'Invalid input';\r\n          if (typeof result === 'string') return result;\r\n        } catch (e) {\r\n          console.error('[PromptJS] Validator threw exception:', e);\r\n          return 'Validation error';\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n\r\n    const contentWrapper = document.createElement('div');\r\n    contentWrapper.className = 'pj-prompt-wrapper';\r\n    \r\n    const messageP = document.createElement('p');\r\n    messageP.className = 'pj-prompt-message';\r\n    messageP.textContent = message;\r\n    contentWrapper.appendChild(messageP);\r\n\r\n    const inputEl = document.createElement('input');\r\n    inputEl.type = opts?.inputType ?? 'text';\r\n    inputEl.className = 'pj-prompt-input';\r\n    inputEl.value = inputValue;\r\n    inputEl.setAttribute('autocomplete', 'off');\r\n    inputEl.setAttribute('spellcheck', 'false');\r\n    if (opts?.placeholder) inputEl.placeholder = opts.placeholder;\r\n    if (opts?.maxLength) inputEl.maxLength = opts.maxLength;\r\n    contentWrapper.appendChild(inputEl);\r\n\r\n    errorEl = document.createElement('div');\r\n    errorEl.className = 'pj-prompt-error';\r\n    errorEl.setAttribute('role', 'alert');\r\n    errorEl.setAttribute('aria-live', 'polite');\r\n    contentWrapper.appendChild(errorEl);\r\n\r\n    inputEl.addEventListener('input', (e) => {\r\n      inputValue = (e.target as HTMLInputElement).value;\r\n      if (errorEl) errorEl.textContent = '';\r\n      inputEl.classList.remove('error');\r\n    });\r\n\r\n    inputEl.addEventListener('focus', () => {\r\n      // Focus styles handled by CSS\r\n    });\r\n\r\n    inputEl.addEventListener('blur', () => {\r\n      // Blur styles handled by CSS\r\n    });\r\n\r\n    // Allow Enter to submit (if valid)\r\n    inputEl.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Enter') {\r\n        e.preventDefault();\r\n        const error = validateInput(inputValue);\r\n        if (error) {\r\n          if (errorEl) {\r\n            errorEl.textContent = error;\r\n            inputEl.classList.add('error');\r\n          }\r\n          return;\r\n        }\r\n        // Validation passed, resolve and close\r\n        safeResolve(inputValue);\r\n        modal.close('ok');\r\n      }\r\n    });\r\n\r\n    const modal = open({\r\n      ...opts,\r\n      title: opts?.title,\r\n      content: contentWrapper,\r\n      buttons: [\r\n        { \r\n          id: 'cancel', \r\n          text: opts?.cancelText ?? config.get().i18n.cancel, \r\n          variant: 'neutral',\r\n          closeOnClick: true,\r\n          onClick: () => safeResolve(null)\r\n        },\r\n        { \r\n          id: 'ok', \r\n          text: opts?.okText ?? config.get().i18n.ok, \r\n          variant: 'primary',\r\n          closeOnClick: false, // Don't auto-close, we'll handle it manually\r\n          onClick: () => {\r\n            const error = validateInput(inputValue);\r\n            if (error) {\r\n              if (errorEl) {\r\n                errorEl.textContent = error;\r\n                inputEl.classList.add('error');\r\n              }\r\n              // Don't close modal, just return\r\n              return;\r\n            }\r\n            // Validation passed, resolve and close\r\n            safeResolve(inputValue);\r\n            modal.close('ok');\r\n          }\r\n        }\r\n      ],\r\n      closeOnEsc: true,\r\n      closeOnBackdrop: false, // Don't lose input on accidental backdrop click\r\n      onClose: (result) => {\r\n        if (result === 'esc' || result === 'backdrop' || result === 'close') {\r\n          safeResolve(null);\r\n        }\r\n      },\r\n      onOpen: () => {\r\n        // Auto-focus the input after modal opens\r\n        setTimeout(() => {\r\n          inputEl.focus();\r\n          if (defaultValue) {\r\n            inputEl.select(); // Select default value if any\r\n          }\r\n        }, 100);\r\n      }\r\n    });\r\n  });\r\n}\r\n","/**\r\n * PromptJS – i18n.ts\r\n * Locale registry and helpers so apps can switch language with one call.\r\n * This updates config.i18n and deep-merges default dialog titles.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n */\r\n\r\nimport { config } from './config';\r\nimport type { I18nBundle } from './types';\r\n\r\nconst registry = new Map<string, I18nBundle>();\r\n\r\nexport function register(bundle: I18nBundle) {\r\n  registry.set(bundle.locale, bundle);\r\n}\r\n\r\nexport function getAvailable(): string[] {\r\n  return Array.from(registry.keys());\r\n}\r\n\r\n/**\r\n * Set the active language. The bundle must be registered first\r\n * (or pass the bundle via use()).\r\n */\r\nexport function set(locale: string) {\r\n  const pack = registry.get(locale);\r\n  if (!pack) throw new Error(`PromptJS: no i18n pack registered for \"${locale}\"`);\r\n  // Let config.update handle deep merge of i18n and i18n.titles\r\n  config.update({ i18n: pack });\r\n}\r\n\r\n/**\r\n * Convenience: register and set in one call.\r\n */\r\nexport function use(locale: string, bundle?: I18nBundle) {\r\n  if (bundle) register(bundle);\r\n  set(locale);\r\n}\r\n\r\n/**\r\n * Load a locale asynchronously (for JSON or code-split modules),\r\n * then register and set it. Returns the loaded bundle.\r\n */\r\nexport function load(locale: string, loader: () => Promise<I18nBundle>) {\r\n  return loader().then(bundle => {\r\n    register(bundle);\r\n    set(locale);\r\n    return bundle;\r\n  });\r\n}\r\n\r\n// Optional: pre-register English so you can switch back explicitly.\r\nregister({\r\n  locale: 'en',\r\n  dir: 'auto',\r\n  ok: 'OK',\r\n  cancel: 'Cancel',\r\n  yes: 'Yes',\r\n  no: 'No',\r\n  close: 'Close',\r\n  dismiss: 'Dismiss',\r\n  titles: {\r\n    info: 'Information',\r\n    success: 'Success',\r\n    warning: 'Warning',\r\n    error: 'Error',\r\n    question: 'Question',\r\n  },\r\n});\r\n","/**\r\n * PromptJS – index.ts\r\n * Entry point for the public API.\r\n * Author: Iftekhar Mahmud Towhid (tlabs.im@gmail.com)\r\n *\r\n * - ESM: re-exports config, Modal, notify, question, confirm, alert, and types.\r\n * - UMD (when bundled): attaches a global `window.PromptJS` for Blade/vanilla usage.\r\n * - No side effects beyond optional global attach when `window` is present.\r\n */\r\n\r\nimport { config } from './config';\r\nimport * as Modal from './modal';\r\nimport { toast } from './toast';\r\nimport { question, confirm, alert, prompt } from './dialogs';\r\nimport * as i18n from './i18n';\r\n\r\ndeclare const __PROMPTJS_VERSION__: string | undefined;\r\n\r\nexport const version =\r\n  typeof __PROMPTJS_VERSION__ !== 'undefined'\r\n    ? __PROMPTJS_VERSION__\r\n    : 'dev';\r\n\r\nexport { config, Modal, toast, question, confirm, alert, prompt, i18n };\r\nexport type { \r\n  ModalOptions, \r\n  ModalInstance,\r\n  AlertOptions,\r\n  ConfirmOptions,\r\n  PromptOptions,\r\n  QuestionOptions,\r\n  ToastOptions\r\n} from \"./types\";\r\n\r\ndeclare global { interface Window { PromptJS?: any } }\r\n\r\nif (typeof window !== 'undefined') {\r\n  const api = { config, Modal, toast, question, confirm, alert, prompt, i18n, version } as const;\r\n  window.PromptJS = Object.freeze(api);\r\n}\r\n"]}